const { validEllipticCurveCoordinates } = require('./ellipticCurveCheck')

describe('validEllipticCurveCoordinates()', () => {
  const coordinates = [
    {
      x: '49790390825249384486033144355916864607616083520101638681403973749255924539515',
      y: '59574132161899900045862086493921015780032175291755807399284007721050341297360'
    },
    {
      x: '38700595561234524902699856340143928453456740398363457588388103701893907432625',
      y: '58931767404721079693931124337962643098415806656500130124440494674334112962259'
    },
    {
      x: '20027008463448765195808520975107966415856775141394038080061884197763336806157',
      y: '29094871692662551094777131657330301450967241330736568830524707441798801616881'
    },
  ]

  coordinates.forEach((point) => {
    it(`point [${point.x},${point.y}] on elliptic curve`, () => {
      expect(validEllipticCurveCoordinates(point.x, point.y)).toBe(true)
    })
  })

  it(`point NOT on elliptic curve`, () => {
    const point = {
      x: '49790390825249384486033144355916864607616083520101638681403973749255924539516',
      y: '59574132161899900045862086493921015780032175291755807399284007721050341297360'
    }

    expect(validEllipticCurveCoordinates(point.x, point.y)).toBe(false)
  })
})
